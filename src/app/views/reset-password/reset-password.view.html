<div class="flex flex-col left-0 top-0 m-0 w-full h-screen overflow-x-auto">
  <div
    class="flex flex-col p-5 m-auto rounded-xl! styleBorderSolidLite border-4! bg-transparent backdrop-blur w-full min-[400px]:w-10/12 sm:w-[400px] text-center"
  >
    <div class="flex flex-col gap-y-3 text-left!" [formGroup]="resetForm">
      <div class="flex flex-col items-center text-center">
        <span class="font-bold text-3xl">Reset Password Form</span>
      </div>

      @if (step() === "email") {
        <div class="flex flex-col my-2">
          <span class="text-lg">Enter your email address to receive a verification code</span>
        </div>

        <div class="flex flex-col gap-y-1">
          <label class="styleLabel">Email</label>
          <input class="styleField" type="text" formControlName="email" />
          @if (isInvalid("email")) {
            @if (f["email"].errors?.["required"]) {
              <span class="text-red-500">Field 'Email' should not be empty</span>
            } @else if (f["email"].errors?.["email"]) {
              <span class="text-red-500">Field 'Email' contains an incorrect email address</span>
            } @else if (f["email"].errors?.["pattern"]) {
              <span class="text-red-500">Field 'Email' contains an invalid mailbox domain</span>
            }
          }
        </div>

        <div class="flex flex-col gap-y-2">
          <button class="styleLinkRedir" (click)="skipToCode()">I already have a code</button>
        </div>

        <div class="flex flex-row justify-end gap-3">
          <button class="styleButDanger" (click)="back()">Cancel</button>
          <button class="styleButSuccess" (click)="onEmailSubmit()">Send Code</button>
        </div>
      } @else if (step() === "code") {
        <div class="flex flex-col my-2">
          <span class="text-lg">
            @if (userEmail()) {
              Enter the 6-digit code sent to {{ userEmail() }}
            } @else {
              Enter your email and the 6-digit verification code
            }
          </span>
        </div>

        @if (!userEmail()) {
          <div class="flex flex-col gap-y-1">
            <label class="styleLabel">Email</label>
            <input class="styleField" type="text" formControlName="email" />
            @if (isInvalid("email")) {
              @if (f["email"].errors?.["required"]) {
                <span class="text-red-500">Field 'Email' should not be empty</span>
              } @else if (f["email"].errors?.["email"]) {
                <span class="text-red-500">Field 'Email' contains an incorrect email address</span>
              } @else if (f["email"].errors?.["pattern"]) {
                <span class="text-red-500">Field 'Email' contains an invalid mailbox domain</span>
              }
            }
          </div>
        }

        <div class="flex flex-col gap-y-1">
          <label class="styleLabel">Verification Code</label>
          <input
            class="styleField text-center text-2xl tracking-widest"
            type="text"
            formControlName="code"
            maxlength="6"
            placeholder="000000"
          />
          @if (isInvalid("code")) {
            @if (f["code"].errors?.["required"]) {
              <span class="text-red-500">Field 'Code' should not be empty</span>
            } @else if (f["code"].errors?.["pattern"]) {
              <span class="text-red-500">Code must be 6 digits</span>
            }
          }
        </div>

        <div class="flex flex-row justify-between gap-3">
          <button class="styleButDanger" (click)="backToEmail()">Back</button>
          <div class="flex gap-3">
            <button class="styleButDanger" (click)="back()">Cancel</button>
            <button class="styleButSuccess" (click)="onCodeSubmit()">Verify</button>
          </div>
        </div>
      }
    </div>
  </div>
</div>
