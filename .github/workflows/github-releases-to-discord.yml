name: GitHub Releases to Discord Forum
on:
  release:
    types: [published]

jobs:
  publish-post-discord:
    runs-on: blacksmith-4vcpu-ubuntu-2404
    steps:
      - name: Checkout
        uses: actions/checkout@v4

      - name: Create Discord Forum Post
        run: |
          # Send the request
          curl -X POST "${{ secrets.WEBHOOK_URL }}" \
            -H "Authorization: Bot ${{ secrets.DISCORD_BOT_TOKEN }}" \
            -H "Content-Type: application/json" \
            --data '{
              "name": "ğŸš€ Task Flow (Beta release ${{ github.event.release.tag_name }})",
              "auto_archive_duration": 4320,
              "message": {
                "content": "**ğŸš€ New Release Available!**\n\nğŸ“¦ **Version:** ${{ github.event.release.tag_name }}\nğŸ”— **Download:** ${{ github.event.release.html_url }}\n\n---\n\n**ğŸ‡·ğŸ‡º Ğ ÑƒÑÑĞºĞ¸Ğ¹ Ğ¿ĞµÑ€ĞµĞ²Ğ¾Ğ´**\n**ğŸš€ ĞĞ¾Ğ²Ğ°Ñ Ğ²ĞµÑ€ÑĞ¸Ñ Ğ´Ğ¾ÑÑ‚ÑƒĞ¿Ğ½Ğ°!**\n\nğŸ“¦ **Ğ’ĞµÑ€ÑĞ¸Ñ:** ${{ github.event.release.tag_name }}\nğŸ”— **Ğ¡ĞºĞ°Ñ‡Ğ°Ñ‚ÑŒ:** ${{ github.event.release.html_url }}"
              }
            }' \
            --fail \
            --show-error
