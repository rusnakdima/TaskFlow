name: GitHub Releases to Discord Forum
on:
  release:
    types: [published]

jobs:
  publish-tauri:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v4

      - name: Create Discord Forum Post
        run: |
          # Send the request
          curl -X POST "${{ secrets.WEBHOOK_URL }}" \
            -H "Authorization: Bot ${{ secrets.DISCORD_BOT_TOKEN }}" \
            -H "Content-Type: application/json" \
            --data '{
              "name": "ğŸš€ Task Flow (Beta release ${{ github.event.release.tag_name }})",
              "auto_archive_duration": 4320,
              "message": {
                "content": "**ğŸš€ New Release Available!**\n\nğŸ“¦ **Version:** ${{ github.event.release.tag_name }}\nğŸ”— **Download:** ${{ github.event.release.html_url }}\n\nğŸ“ **Release Notes:**\nInformation about the changes is shown in the picture.\n\n---\n\n**ğŸ‡·ğŸ‡º Ğ ÑƒÑÑĞºĞ¸Ğ¹ Ğ¿ĞµÑ€ĞµĞ²Ğ¾Ğ´**\n**ğŸš€ ĞĞ¾Ğ²Ğ°Ñ Ğ²ĞµÑ€ÑĞ¸Ñ Ğ´Ğ¾ÑÑ‚ÑƒĞ¿Ğ½Ğ°!**\n\nğŸ“¦ **Ğ’ĞµÑ€ÑĞ¸Ñ:** ${{ github.event.release.tag_name }}\nğŸ”— **Ğ¡ĞºĞ°Ñ‡Ğ°Ñ‚ÑŒ:** ${{ github.event.release.html_url }}\n\nğŸ“ **ĞŸÑ€Ğ¸Ğ¼ĞµÑ‡Ğ°Ğ½Ğ¸Ñ Ğº Ğ²Ñ‹Ğ¿ÑƒÑĞºÑƒ:**\nĞ˜Ğ½Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ†Ğ¸Ñ Ğ¾Ğ± Ğ¸Ğ·Ğ¼ĞµĞ½ĞµĞ½Ğ¸ÑÑ… Ğ¸Ğ·Ğ¾Ğ±Ñ€Ğ°Ğ¶ĞµĞ½Ğ° Ğ½Ğ° ĞºĞ°Ñ€Ñ‚Ğ¸Ğ½ĞºĞµ."
              }
            }' \
            --fail \
            --show-error
